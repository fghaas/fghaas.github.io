
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index,follow" />


    <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../../theme/pygments/github.min.css">

    <link rel="stylesheet" 
    href="../../../theme/tipuesearch/tipuesearch.min.css" />


  <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="/css/override.css">



  <link href="https://xahteiwi.eu/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="xahteiwi.eu Atom">

  <link href="https://xahteiwi.eu/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="xahteiwi.eu RSS">


<script defer data-domain="xahteiwi.eu" src="https://plausible.io/js/plausible.js"></script>

 

<meta name="author" content="Florian Haas" />
<meta name="description" content="Note: This article was originally written for SUSE OpenStack Cloud 6, and updated for SUSE OpenStack Cloud 7. It may not apply to later SUSE OpenStack Cloud releases. If you’re using SUSE OpenStack Cloud, you may want to erase and reinstall your cloud deployment a few times during the …" />
<meta name="keywords" content="OpenStack, SUSE">


  <meta property="og:site_name" content="xahteiwi.eu"/>
  <meta property="og:title" content="Wiping and resetting your SUSE OpenStack Cloud Crowbar configuration"/>
  <meta property="og:description" content="Note: This article was originally written for SUSE OpenStack Cloud 6, and updated for SUSE OpenStack Cloud 7. It may not apply to later SUSE OpenStack Cloud releases. If you’re using SUSE OpenStack Cloud, you may want to erase and reinstall your cloud deployment a few times during the …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../../resources/hints-and-kinks/wipe-suse-openstack-cloud-config/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2016-07-05 00:00:00+00:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../../author/florian-haas.html">
  <meta property="article:section" content="hints-and-kinks"/>
  <meta property="article:tag" content="OpenStack"/>
  <meta property="article:tag" content="SUSE"/>
  <meta property="og:image" content="https://xahteiwi.eu/images/avatar.jpg">

  <title>xahteiwi.eu &ndash; Wiping and resetting your SUSE OpenStack Cloud Crowbar configuration</title>


</head>
<body >

<aside>
  <div>
    <a href="../../../">
      <img src="https://xahteiwi.eu/images/avatar.jpg" alt="" title="">
    </a>

    <h1>
      <a href="../../../"></a>
    </h1>


    <form class="navbar-search" action="../../../search.html" role="search">
      <input type="text" name="q" id="tipue_search_input" placeholder="Search...">
    </form>


    <ul class="social">
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://mastodon.social/@xahteiwi"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/fghaas"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/fghaas"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="../../../">Home</a>

  <a href="/category/hints-and-kinks.html">Tech</a>
  <a href="/category/presentations.html">Talks</a>
  <a href="/category/blog.html">Thoughts</a>
  <a href="">​</a>
  <a href="/about/">About</a>
  <a href="/comments/">Comments</a>
  <a href="/legal/">Legal</a>
  <a href="/privacy/">Privacy</a>
  <a href="">​</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>
  <a href="">​</a>

  <a href="https://xahteiwi.eu/feeds/all.atom.xml">Atom</a>

  <a href="https://xahteiwi.eu/feeds/all.rss.xml">RSS</a>
</nav>

<article class="single">
  <header>
      
    <h1 id="wipe-suse-openstack-cloud-config">Wiping and resetting your SUSE OpenStack Cloud Crowbar configuration</h1>
    <p>
      Posted on Tue 05 July 2016 in <a href="../../../category/hints-and-kinks.html">hints-and-kinks</a>

        &#8226; 2 min read
    </p>
  </header>


  <div>
    <p><strong>Note: This article was originally written for SUSE OpenStack Cloud
6, and updated for SUSE OpenStack Cloud 7. It may not apply to later
SUSE OpenStack Cloud releases.</strong></p>
<p>If you’re using <a href="https://www.suse.com/products/suse-openstack-cloud">SUSE OpenStack
Cloud</a>, you may
want to erase and reinstall your cloud deployment a few times during
the testing or proof-of-concept phase. You may also want to experiment
with a few permutations of Crowbar network configurations. SUSE’s
(otherwise excellent) <a href="https://www.suse.com/documentation/suse-openstack-cloud-7/book_cloud_deploy/data/book_cloud_deploy.html">Deployment
Guide</a>
suggests that the only way to change your Crowbar settings, after
<code>install-suse-cloud</code> has been run, <a href="https://www.suse.com/documentation/suse-openstack-cloud-7/book_cloud_deploy/data/sec_depl_adm_inst_crowbar_network.html">is to reinstall your entire admin
node</a>.
That isn’t really true if you know what you’re doing.</p>
<p>You may be thinking that you could just use
<a href="http://snapper.io/"><code>snapper</code></a> to
<a href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_snapper_auto.html">revert to your last Btrfs snapshot</a>
created before you ran <code>install-suse-cloud</code>. After all, running <code>yast2
crowbar</code>, like any other YaST module, automatically creates a
before-and-after Btrfs snapshot of your root filesystem and all its
subvolumes. So, reboot machine, select pre-<code>install-suse-cloud</code>
snapshot, complete boot, run <code>snapper rollback</code>, done. Right?</p>
<p>Well, not quite. If you
<a href="https://www.suse.com/documentation/suse-openstack-cloud-7/book_cloud_deploy/data/sec_depl_adm_inst_partition.html">followed the Deployment Guide closely,</a>
you will have removed your Btrfs subvolume for the <code>/srv</code> directory,
and replaced it with a separate, XFS-formatted partition. That means
it is excluded from all <code>snapper</code> Btrfs snapshots, and thus, no
rollback for you for that directory. Which, of course, Crowbar uses
rather extensively.</p>
<p>So, here is your checklist for resetting your admin node to a
pre-<code>install-suse-cloud</code> state:</p>
<ul>
<li>
<p>Reboot your admin node.</p>
</li>
<li>
<p>In the SLES boot menu, select an appropriate snapshot taken
  immediately prior to running <code>install-suse-cloud</code>.</p>
</li>
<li>
<p>Boot into your snapshot.</p>
</li>
<li>
<p>Run <code>snapper rollback</code>.</p>
</li>
<li>
<p>Reboot again.</p>
</li>
<li>
<p>After rebooting, delete the following and directories:</p>
<ul>
<li><code>/srv/tftpboot/authorized_keys</code></li>
<li><code>/srv/tftpboot/validation.pem</code></li>
<li>all subdirectories under <code>/srv/tftpboot/nodes/</code></li>
</ul>
</li>
</ul>
<p>Then, you can reconfigure Crowbar (<code>yast2 crowbar</code>), run
<code>install-suse-cloud</code>, and reboot your OpenStack nodes. They should be
discovered anew, and you’re then able to redeploy your OpenStack
barclamps to them.</p>
<hr/>
<p>This article originally appeared on the <code>hastexo.com</code> website (now defunct).</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../../tag/openstack.html">OpenStack</a>
      <a href="../../../tag/suse.html">SUSE</a>
    </p>
  </div>






</article>

<footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike License</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " xahteiwi.eu ",
  "url" : "../../..",
  "image": "https://xahteiwi.eu/images/avatar.jpg",
  "description": ""
}
</script>
</body>
</html>